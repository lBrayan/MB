import './polyfills.server.mjs';
import{a as v,b as G,c as J,d as K,e as I,h as $,n as ee}from"./chunk-CZ3FO22V.mjs";import{$ as R,Ba as U,Ca as y,Da as s,Ea as l,Fa as d,Ga as V,Ha as B,I as x,Ia as H,J as m,Ja as Q,Ka as z,La as L,Ma as u,Na as W,O as E,Oa as q,P as p,Pa as f,S as c,V as w,_ as D,db as X,ha as _,hb as Y,ia as M,mb as Z,na as S,nb as g,pa as h,qa as P,qb as C,ra as T,s as F,sa as N,ta as O,va as j,wa as k}from"./chunk-3UCPAPKS.mjs";var te=(()=>{class o{constructor(e){this.http=e,this.apiUrl="http://localhost:8000/api/process-frame/"}detectPlate(e){let t=new FormData;return t.append("frame",e),this.http.post(this.apiUrl,t)}static{this.\u0275fac=function(t){return new(t||o)(E(v))}}static{this.\u0275prov=m({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var re={backend:"https://placas.brayanroa.com/api"};var pe=["videoElement"];function ce(o,r){if(o&1&&(s(0,"div")(1,"h3"),u(2,"Texto Detectado:"),l(),s(3,"p"),u(4),l()()),o&2){let e=H();h(4),W(e.detectedText)}}var ie=(()=>{class o{constructor(e){this.http=e,this.detectedText="",this.data64Img="",this.platformID=p(_)}ngOnInit(){C(this.platformID)&&(this.startCamera(),C(this.platformID)&&F(500).subscribe(()=>{this.captureFrame()}))}startCamera(){navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{this.videoElement.nativeElement.srcObject=e}).catch(e=>{console.error("Error al acceder a la c\xE1mara: ",e)})}captureFrame(){let e=document.createElement("canvas"),t=e.getContext("2d");e.width=this.videoElement.nativeElement.videoWidth,e.height=this.videoElement.nativeElement.videoHeight,t?.drawImage(this.videoElement.nativeElement,0,0);let i=e.toDataURL("image/jpeg");this.data64Img=i,this.sendFrameToServer(i)}sendFrameToServer(e){this.http.post(re.backend+"/detect_plate",{image:e}).subscribe(t=>{this.detectedText=t.plate.slice(0,7)},t=>{console.error("Error al enviar la imagen al servidor",t)})}static{this.\u0275fac=function(t){return new(t||o)(P(v))}}static{this.\u0275cmp=c({type:o,selectors:[["app-camera"]],viewQuery:function(t,i){if(t&1&&Q(pe,5),t&2){let n;z(n=L())&&(i.videoElement=n.first)}},standalone:!0,features:[q([te]),f],decls:7,vars:2,consts:[["videoElement",""],[1,"camera-container"],["autoplay","","playsinline",""],[3,"click"],[4,"ngIf"],["alt","",3,"src"]],template:function(t,i){if(t&1){let n=V();s(0,"div",1),d(1,"video",2,0),s(3,"button",3),B("click",function(){return D(n),R(i.captureFrame())}),u(4,"Capturar Foto"),l(),U(5,ce,5,1,"div",4),d(6,"img",5),l()}t&2&&(h(5),y("ngIf",i.detectedText),h(),y("src",i.data64Img,S))},dependencies:[G,g,Z]})}}return o})();var oe=(()=>{class o{constructor(){this.title="BM"}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=c({type:o,selectors:[["app-root"]],standalone:!0,features:[f],decls:1,vars:0,template:function(t,i){t&1&&d(0,"app-camera")},dependencies:[ie,g]})}}return o})();var ne=[];var he="@",ue=(()=>{class o{constructor(e,t,i,n,a){this.doc=e,this.delegate=t,this.zone=i,this.animationType=n,this.moduleImpl=a,this._rendererFactoryPromise=null,this.scheduler=p(N,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-LHLDVPVS.mjs")).catch(t=>{throw new x(5300,!1)}).then(({\u0275createEngine:t,\u0275AnimationRendererFactory:i})=>{this._engine=t(this.animationType,this.doc,this.scheduler);let n=new i(this.delegate,this._engine,this.zone);return this.delegate=n,n})}createRenderer(e,t){let i=this.delegate.createRenderer(e,t);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let n=new A(i);return t?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let de=a.createRenderer(e,t);n.use(de)}).catch(a=>{n.use(i)}),n}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(t){T()}}static{this.\u0275prov=m({token:o,factory:o.\u0275fac})}}return o})(),A=class{constructor(r){this.delegate=r,this.replay=[],this.\u0275type=1}use(r){if(this.delegate=r,this.replay!==null){for(let e of this.replay)e(r);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(r,e){return this.delegate.createElement(r,e)}createComment(r){return this.delegate.createComment(r)}createText(r){return this.delegate.createText(r)}get destroyNode(){return this.delegate.destroyNode}appendChild(r,e){this.delegate.appendChild(r,e)}insertBefore(r,e,t,i){this.delegate.insertBefore(r,e,t,i)}removeChild(r,e,t){this.delegate.removeChild(r,e,t)}selectRootElement(r,e){return this.delegate.selectRootElement(r,e)}parentNode(r){return this.delegate.parentNode(r)}nextSibling(r){return this.delegate.nextSibling(r)}setAttribute(r,e,t,i){this.delegate.setAttribute(r,e,t,i)}removeAttribute(r,e,t){this.delegate.removeAttribute(r,e,t)}addClass(r,e){this.delegate.addClass(r,e)}removeClass(r,e){this.delegate.removeClass(r,e)}setStyle(r,e,t,i){this.delegate.setStyle(r,e,t,i)}removeStyle(r,e,t){this.delegate.removeStyle(r,e,t)}setProperty(r,e,t){this.shouldReplay(e)&&this.replay.push(i=>i.setProperty(r,e,t)),this.delegate.setProperty(r,e,t)}setValue(r,e){this.delegate.setValue(r,e)}listen(r,e,t){return this.shouldReplay(e)&&this.replay.push(i=>i.listen(r,e,t)),this.delegate.listen(r,e,t)}shouldReplay(r){return this.replay!==null&&r.startsWith(he)}};function ae(o="animations"){return j("NgAsyncAnimations"),w([{provide:O,useFactory:(r,e,t)=>new ue(r,e,t,o),deps:[Y,J,k]},{provide:M,useValue:o==="noop"?"NoopAnimations":"BrowserAnimations"}])}var se={providers:[ee(ne),I(),ae(),I()]};var fe={providers:[$()]},le=X(se,fe);var ge=()=>K(oe,le),Ge=ge;export{Ge as a};
